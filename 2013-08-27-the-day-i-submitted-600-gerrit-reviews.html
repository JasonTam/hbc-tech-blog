<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>The Day I Submitted 600 Gerrit Reviews</title><title>The Day I Submitted 600 Gerrit Reviews | HBC Tech</title><meta property="og:title" content="The Day I Submitted 600 Gerrit Reviews"><meta name="author" content="HBC Tech"><meta property="og:locale" content="en_US"><meta name="description" content="It&rsquo;s well known that code review is an important tool for improving quality, and we use Gerrit extensively at Gilt for that purpose. But there are also some less obvious benefits of such tools. With a system composed of hundreds of small services, applications, database schemas, libraries, and toolsets&ndash;each hosted in its own Git repository&ndash;maintaining certain standards across all of them is essential, but challenging. We may want to ensure that a certain configuration or other metadata is provided by each repo, for example. Or we might want to strongly encourage application developers to update a core library. Our tools for bootstrapping a new repository help us to make sure that current standards are followed, but it&rsquo;s easy for existing repositories to get out of date. This is where Gerrit comes in: it becomes possible to run scripts against all of our repositories that propose a change of this sort then submit it to the owners of the repository to review. It would be irresponsible to blindly make such automated changes to all of our systems, and one individual can&rsquo;t realistically review every single repository&ndash;but by distributing the burden of the reviews out to the people most familiar with the system in question, we solve both of these problems. Of course, there&rsquo;s one prerequisite to doing this type of thing, which is that you need to know who the right people are to review changes to a given repository. We have a standard for this: a reviewers.yml file in the repository containing the information, and a Gerrit hook that adds reviewers to all new patch sets based on the contents. Now we just need to bootstrap these files with a guess at the right people. To do this, I ran the following shell script a couple days ago (for simplicity, I&rsquo;ve elided a few unimportant details): for project in `gg-gerrit-ls-projects`; do gg-gerrit-clone $project || continue cd $project"><meta property="og:description" content="It&rsquo;s well known that code review is an important tool for improving quality, and we use Gerrit extensively at Gilt for that purpose. But there are also some less obvious benefits of such tools. With a system composed of hundreds of small services, applications, database schemas, libraries, and toolsets&ndash;each hosted in its own Git repository&ndash;maintaining certain standards across all of them is essential, but challenging. We may want to ensure that a certain configuration or other metadata is provided by each repo, for example. Or we might want to strongly encourage application developers to update a core library. Our tools for bootstrapping a new repository help us to make sure that current standards are followed, but it&rsquo;s easy for existing repositories to get out of date. This is where Gerrit comes in: it becomes possible to run scripts against all of our repositories that propose a change of this sort then submit it to the owners of the repository to review. It would be irresponsible to blindly make such automated changes to all of our systems, and one individual can&rsquo;t realistically review every single repository&ndash;but by distributing the burden of the reviews out to the people most familiar with the system in question, we solve both of these problems. Of course, there&rsquo;s one prerequisite to doing this type of thing, which is that you need to know who the right people are to review changes to a given repository. We have a standard for this: a reviewers.yml file in the repository containing the information, and a Gerrit hook that adds reviewers to all new patch sets based on the contents. Now we just need to bootstrap these files with a guess at the right people. To do this, I ran the following shell script a couple days ago (for simplicity, I&rsquo;ve elided a few unimportant details): for project in `gg-gerrit-ls-projects`; do gg-gerrit-clone $project || continue cd $project"><link rel="canonical" href="https://saksdirect.github.io/hbc-tech-blog/2013-08-27-the-day-i-submitted-600-gerrit-reviews.html"><meta property="og:url" content="https://saksdirect.github.io/hbc-tech-blog/2013-08-27-the-day-i-submitted-600-gerrit-reviews.html"><meta property="og:site_name" content="HBC Tech"><meta property="og:type" content="article"><meta property="article:published_time" content="2013-08-27T17:14:00-05:00"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@"><meta name="twitter:creator" content="@HBC Tech"><script type="application/ld+json">{"name":null,"description":"It&rsquo;s well known that code review is an important tool for improving quality, and we use Gerrit extensively at Gilt for that purpose. But there are also some less obvious benefits of such tools. With a system composed of hundreds of small services, applications, database schemas, libraries, and toolsets&ndash;each hosted in its own Git repository&ndash;maintaining certain standards across all of them is essential, but challenging. We may want to ensure that a certain configuration or other metadata is provided by each repo, for example. Or we might want to strongly encourage application developers to update a core library. Our tools for bootstrapping a new repository help us to make sure that current standards are followed, but it&rsquo;s easy for existing repositories to get out of date. This is where Gerrit comes in: it becomes possible to run scripts against all of our repositories that propose a change of this sort then submit it to the owners of the repository to review. It would be irresponsible to blindly make such automated changes to all of our systems, and one individual can&rsquo;t realistically review every single repository&ndash;but by distributing the burden of the reviews out to the people most familiar with the system in question, we solve both of these problems. Of course, there&rsquo;s one prerequisite to doing this type of thing, which is that you need to know who the right people are to review changes to a given repository. We have a standard for this: a reviewers.yml file in the repository containing the information, and a Gerrit hook that adds reviewers to all new patch sets based on the contents. Now we just need to bootstrap these files with a guess at the right people. To do this, I ran the following shell script a couple days ago (for simplicity, I&rsquo;ve elided a few unimportant details): for project in `gg-gerrit-ls-projects`; do gg-gerrit-clone $project || continue cd $project","author":{"@type":"Person","name":"HBC Tech"},"@type":"BlogPosting","url":"https://saksdirect.github.io/hbc-tech-blog/2013-08-27-the-day-i-submitted-600-gerrit-reviews.html","publisher":null,"image":null,"headline":"The Day I Submitted 600 Gerrit Reviews","dateModified":"2013-08-27T17:14:00-05:00","datePublished":"2013-08-27T17:14:00-05:00","sameAs":null,"mainEntityOfPage":{"@type":"WebPage","@id":"https://saksdirect.github.io/hbc-tech-blog/2013-08-27-the-day-i-submitted-600-gerrit-reviews.html"},"@context":"http://schema.org"}</script><link rel="stylesheet" href="https://saksdirect.github.io/hbc-tech-blog/assets/css/main.css"><link rel="canonical" href="https://saksdirect.github.io/hbc-tech-blog/2013-08-27-the-day-i-submitted-600-gerrit-reviews.html"><link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,700" rel="stylesheet"><link rel="shortcut icon" href="https://saksdirect.github.io/hbc-tech-blog/assets/images/favicon.ico"></head><body aria-label="Content"><header id="site-header" class="site-header"><div class="site-header__inner"><a class="site-header__logo" href="https://saksdirect.github.io/hbc-tech-blog/"><svg class="hbc-tech-logo" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 64 52"><use class="hbc-tech-logo__text" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#hbc-tech-logo"></use></svg></a><p class="sticky-nav-meta"><a href="https://saksdirect.github.io/hbc-tech-blog/categories/#" class="meta__category"></a> <span class="slug-divider"></span> <span class="meta__title">The Day I Submitted 600 Gerrit Reviews</span></p><nav id="menu" class="navigation"><svg class="navigation__menu-icon" xmlns="http://www.w3.org/2000/svg"><path class="bar bar__top" d="M0,3 L30,3"></path><path class="bar bar__cross-1" d="M0,14 L30,14"></path><path class="bar bar__cross-2" d="M0,14 L30,14"></path><path class="bar bar__bottom" d="M0,25 L30,25"></path></svg><menu class="menu"><ul class="link-list"><li class="link-list__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/" class="link-list__link"><span class="link-list__link-highlight">Insights</span></a></li><li class="link-list__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/code" class="link-list__link"><span class="link-list__link-highlight">Code</span></a></li><li class="link-list__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/about" class="link-list__link"><span class="link-list__link-highlight">About</span></a></li><li class="link-list__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/work-here" class="link-list__link"><span class="link-list__link-highlight">Work Here</span></a></li></ul></menu></nav><search id="header-search" class="header-search"><form class="header-search__form"><input type="text" class="header-search__input" id="header-search-input" placeholder="Search" name="query"></form><svg id="header-search__toggle" class="header-search__svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 64 52"><use class="header-search__icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#search"></use></svg><section class="header-search__results" id="header-search__results"></section></search></div></header><section class="content"><article class="article"><header class="article__header article__header--reveal"><h1 class="header-title" title="The Day I Submitted 600 Gerrit Reviews">The Day I Submitted 600 Gerrit Reviews</h1><span id="no-image-placeholder" class="no-image-placeholder"></span> <span class="slug-divider"></span> <span class="article-meta__author">HBC Tech</span> <span class="slug-divider"></span> <span class="article-meta__date">AUG 27, 2013</span></header><section class="article__content article__content--reveal"><div class="article__content__read-time"><span class="read-time" title="Estimated read time"><span class="read-time__text-1">3 min</span> <span class="read-time__text-2">Read</span> <span class="read-time__text-3">Time</span></span></div><div class="article__content__share-buttons"><ul class="share-buttons"><li class="share-buttons__link-item"><a href="https://twitter.com/intent/tweet?text=https://saksdirect.github.io/hbc-tech-blog//2013-08-27-the-day-i-submitted-600-gerrit-reviews.html" class="share-buttons__link" title="Share on Twitter"><svg class="hbc-svg-icon" height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon--twitter" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#twitter"></use></svg></a></li><li class="share-buttons__link-item"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://saksdirect.github.io/hbc-tech-blog/&source=/2013-08-27-the-day-i-submitted-600-gerrit-reviews.html&title=The Day I Submitted 600 Gerrit Reviews" class="share-buttons__link" title="Share on Linkedin"><svg height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#linkedin"></use></svg></a></li><li class="share-buttons__link-item"><a href="https://www.facebook.com/sharer/sharer.php?u=https://saksdirect.github.io/hbc-tech-blog//2013-08-27-the-day-i-submitted-600-gerrit-reviews.html" class="share-buttons__link" title="Share on Facebook"><svg height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#facebook"></use></svg></a></li><li class="share-buttons__link-item"><a href="https://www.reddit.com/submit?url=https://saksdirect.github.io/hbc-tech-blog//2013-08-27-the-day-i-submitted-600-gerrit-reviews.html" class="share-buttons__link" title="Share on Reddit"><svg height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#reddit"></use></svg></a></li></ul></div><div class="article__content__body"><p>It&rsquo;s well known that code review is an important tool for improving quality, and we use Gerrit extensively at Gilt for that purpose. But there are also some less obvious benefits of such tools.</p><p>With a system composed of hundreds of small services, applications, database schemas, libraries, and toolsets&ndash;each hosted in its own Git repository&ndash;maintaining certain standards across all of them is essential, but challenging. We may want to ensure that a certain configuration or other metadata is provided by each repo, for example. Or we might want to strongly encourage application developers to update a core library. Our tools for bootstrapping a new repository help us to make sure that current standards are followed, but it&rsquo;s easy for existing repositories to get out of date.</p><p>This is where Gerrit comes in: it becomes possible to run scripts against all of our repositories that propose a change of this sort then submit it to the owners of the repository to review. It would be irresponsible to blindly make such automated changes to all of our systems, and one individual can&rsquo;t realistically review every single repository&ndash;but by distributing the burden of the reviews out to the people most familiar with the system in question, we solve both of these problems.</p><p>Of course, there&rsquo;s one prerequisite to doing this type of thing, which is that you need to know who the right people are to review changes to a given repository. We have a standard for this: a reviewers.yml file in the repository containing the information, and a Gerrit hook that adds reviewers to all new patch sets based on the contents. Now we just need to bootstrap these files with a guess at the right people. To do this, I ran the following shell script a couple days ago (for simplicity, I&rsquo;ve elided a few unimportant details):</p><pre>for project in `gg-gerrit-ls-projects`; do
    gg-gerrit-clone $project || continue
    cd $project

    yml="reviewers.yml"

    if [ ! -f $yml ] ; then
        reviewers=`git log -n 20 --pretty=tformat:%aE | sort | uniq -c | sort -nr | head -n 3 | awk '{print $2}'`

        touch $yml
        echo "master:" &gt;&gt; $yml
        for r in $reviewers; do
            echo "  - $r" &gt;&gt; $yml
        done

        if git add $yml &amp;&amp; git commit -m "autopopulate reviewers.yml" &amp;&amp; git push origin HEAD:refs/for/master ; then

            changeid=`git show | grep Change-Id | head -n1 | cut -d: -f2`

            for r in $reviewers; do
                gg-gerrit-set-reviewer --add --name $r --project $project --changeid $changeid
            done
        fi
    fi
    cd ..
done
</pre><p>This runs through all of our projects, checks to see if the reviewers file exists, and, if it doesn&rsquo;t already, the script makes a guess that the top three authors from the past 20 commits are a reasonable set of reviewers. It then submits that as a patch set to Gerrit, and adds that same set of people as reviewers. (For the curious, the gg-gerrit-* commands are wrapper scripts to the Gerrit CLI.)</p><p>After a few days, the identified reviewers have already looked over and approved the submitted patches, sometimes with modifications. Because there were no potential negative consequences, I then ran another small shell script which also used the Gerrit CLI to find, approve, and submit the remaining ones. Six hundred repositories had been updated to a current standard&ndash;a feat which would have been nearly impossible without the freedom which code review gives us to make heuristic or speculative changes from automated tools and the power of the Gerrit command line interface.</p></div><footer class="article__content__footer"><div class="article-tags"><span class="article-tags__tag">git</span><span>,</span> <span class="article-tags__tag">gerrit</span><span>,</span> <span class="article-tags__tag">microservices</span><span>,</span> <span class="article-tags__tag">losa</span><span>,</span> <span class="article-tags__tag">code review</span></div><section class="author-bio"><svg class="author__avatar" height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon hbc-svg-icon--avatar__circle" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#circle"></use><use class="hbc-svg-icon hbc-svg-icon--avatar__head" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#head"></use><use class="hbc-svg-icon hbc-svg-icon--avatar__body" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#body"></use></svg><span class="author__name">HBC Tech</span></section></footer></section><aside class="recirc"><h2 class="header__title">Recent Insights</h2><span class="slug-divider"></span> <a class="header__view-all-link" href="https://saksdirect.github.io/hbc-tech-blog/categories/index.html">See All</a><div class="recirc__articles"><article class="recirc__articles__item"><section class="snippet"><h1 class="snippet__title"><a href="https://saksdirect.github.io/hbc-tech-blog/2017-08-10-midyear-recap.html" class="snippet__title__link" title="HBC Tech Talks: February 2017 through July 2017">HBC Tech Talks: February 2017 through July 2017</a></h1><div class="snippet__meta"><a class="meta__category-link" href="https://saksdirect.github.io/hbc-tech-blog/category/events">events</a> <span class="slug-divider"></span> <span class="meta__author">HBC Tech</span> <span class="slug-divider"></span> <span class="meta__date">AUG 10, 2017</span></div><a href="https://saksdirect.github.io/hbc-tech-blog/2017-08-10-midyear-recap.html" class="snippet__excerpt__link" title="HBC Tech Talks: February 2017 through July 2017"><p class="snippet__excerpt">We’ve had a busy 2017 at HBC. The great work of our teams has created opportunities to share what we’ve learned with audiences around the world. This year our folks have been on stage in Austin, Sydney, Portland, Seattle, San Diego, Boston, London, Israel and on our home turf in NYC and Dublin. The talks have covered deep learning, design thinking, data streaming and developer experience to name just a...</p></a></section></article><article class="recirc__articles__item"><section class="snippet"><h1 class="snippet__title"><a href="https://saksdirect.github.io/hbc-tech-blog/2017-06-29-open-source-friday.html" class="snippet__title__link" title="Open Source Friday">Open Source Friday</a></h1><div class="snippet__meta"><a class="meta__category-link" href="https://saksdirect.github.io/hbc-tech-blog/category/culture">culture</a> <span class="slug-divider"></span> <span class="meta__author">HBC Tech</span> <span class="slug-divider"></span> <span class="meta__date">JUN 29, 2017</span></div><a href="https://saksdirect.github.io/hbc-tech-blog/2017-06-29-open-source-friday.html" class="snippet__excerpt__link" title="Open Source Friday"><p class="snippet__excerpt">From the 54 public repos maintained at code.gilt.com to the name of our tech blog (displayed in this tab’s header), open source has been part of our team’s DNA for years. Check out this blog post from 2015 if you’re not convinced.</p></a></section></article><article class="recirc__articles__item"><section class="snippet"><h1 class="snippet__title"><a href="https://saksdirect.github.io/hbc-tech-blog/2017-06-12-hbc-at-qcon.html" class="snippet__title__link" title="Hudson's Bay Company at QCon">Hudson's Bay Company at QCon</a></h1><div class="snippet__meta"><a class="meta__category-link" href="https://saksdirect.github.io/hbc-tech-blog/category/events">events</a> <span class="slug-divider"></span> <span class="meta__author">HBC Tech</span> <span class="slug-divider"></span> <span class="meta__date">JUN 12, 2017</span></div><a href="https://saksdirect.github.io/hbc-tech-blog/2017-06-12-hbc-at-qcon.html" class="snippet__excerpt__link" title="Hudson's Bay Company at QCon"><p class="snippet__excerpt">Heading to QCon? Don’t miss these two sessions! If you can’t make it, stay tuned here for slides and recordings from the conference.</p></a></section></article><article class="recirc__articles__item"><section class="snippet"><h1 class="snippet__title"><a href="https://saksdirect.github.io/hbc-tech-blog/2017-01-11-nyc-scrum-user-group-meetup.html" class="snippet__title__link" title="NYC Scrum User Group - January 19th">NYC Scrum User Group - January 19th</a></h1><div class="snippet__meta"><a class="meta__category-link" href="https://saksdirect.github.io/hbc-tech-blog/category/events">events</a> <span class="slug-divider"></span> <span class="meta__author">HBC Tech</span> <span class="slug-divider"></span> <span class="meta__date">JAN 11, 2017</span></div><a href="https://saksdirect.github.io/hbc-tech-blog/2017-01-11-nyc-scrum-user-group-meetup.html" class="snippet__excerpt__link" title="NYC Scrum User Group - January 19th"><p class="snippet__excerpt">We’ll be hosting our first meetup of 2017 in partnership with the NYC Scrum User Group on Thursday, January 19th. This is our first time hosting this group and we’re off to a great start: Ken Rubin will be joining us to lead a talk on Agile.</p></a></section></article></div></aside></article></section><footer class="footer"><svg class="est1670" xmlns="http://www.w3.org/2000/svg"><use class="hbc-tech-logo__use" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#est1670"></use></svg><section class="footer__links"><ul class="social-links social-links__list"><li class="social-links__list-item"><a class="social-links__link" rel="next" href="#"><svg class="social-links__icon" xmlns="http://www.w3.org/2000/svg"><use class="linkedin" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#linkedin"></use></svg></a></li><li class="social-links__list-item"><a class="social-links__link" rel="next" href="#"><svg class="social-links__icon" xmlns="http://www.w3.org/2000/svg"><use class="twitter" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#twitter"></use></svg></a></li><li class="social-links__list-item"><a class="social-links__link" rel="next" href="#"><svg class="social-links__icon" xmlns="http://www.w3.org/2000/svg"><use class="instagram" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#instagram"></use></svg></a></li></ul><p class="copyright">&copy; 2017 HBC Tech</p></section></footer><script type="text/javascript" src="https://saksdirect.github.io/hbc-tech-blog/assets/js/vendor/scrollmagic/ScrollMagic.min.js"></script><script type="text/javascript" src="https://saksdirect.github.io/hbc-tech-blog/assets/js/vendor/jekyll-search-js/fetch.js"></script><script type="text/javascript" src="https://saksdirect.github.io/hbc-tech-blog/assets/js/vendor/jekyll-search-js/search.js"></script><script type="text/javascript" src="https://saksdirect.github.io/hbc-tech-blog/assets/js/main.js"></script></body></html>