<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>iOS Custom Gesture Recognizer</title><title>iOS Custom Gesture Recognizer | HBC Tech</title><meta property="og:title" content="iOS Custom Gesture Recognizer"><meta name="author" content="Paul Lee"><meta property="og:locale" content="en_US"><meta name="description" content="Developing New Product Photo Gallery As part of our Mobile team’s ongoing effort to introduce more Swift-based pages in the iOS app, I recently started working on a full screen gallery feature on our Product Detail Page (PDP). The feature is similar to the typical full screen photo gallery users will recognize from many other apps, including Apple’s Photo app and e-commerce applications featuring full screen view of product images."><meta property="og:description" content="Developing New Product Photo Gallery As part of our Mobile team’s ongoing effort to introduce more Swift-based pages in the iOS app, I recently started working on a full screen gallery feature on our Product Detail Page (PDP). The feature is similar to the typical full screen photo gallery users will recognize from many other apps, including Apple’s Photo app and e-commerce applications featuring full screen view of product images."><link rel="canonical" href="https://saksdirect.github.io/hbc-tech-blog/ios/2016/09/26/custom-ios-gesture-recognizer/"><meta property="og:url" content="https://saksdirect.github.io/hbc-tech-blog/ios/2016/09/26/custom-ios-gesture-recognizer/"><meta property="og:site_name" content="HBC Tech"><meta property="og:type" content="article"><meta property="article:published_time" content="2016-09-26T00:00:00-05:00"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@"><meta name="twitter:creator" content="@Paul Lee"><script type="application/ld+json">{"name":null,"description":"Developing New Product Photo Gallery As part of our Mobile team’s ongoing effort to introduce more Swift-based pages in the iOS app, I recently started working on a full screen gallery feature on our Product Detail Page (PDP). The feature is similar to the typical full screen photo gallery users will recognize from many other apps, including Apple’s Photo app and e-commerce applications featuring full screen view of product images.","author":{"@type":"Person","name":"Paul Lee"},"@type":"BlogPosting","url":"https://saksdirect.github.io/hbc-tech-blog/ios/2016/09/26/custom-ios-gesture-recognizer/","publisher":null,"image":null,"headline":"iOS Custom Gesture Recognizer","dateModified":"2016-09-26T00:00:00-05:00","datePublished":"2016-09-26T00:00:00-05:00","sameAs":null,"mainEntityOfPage":{"@type":"WebPage","@id":"https://saksdirect.github.io/hbc-tech-blog/ios/2016/09/26/custom-ios-gesture-recognizer/"},"@context":"http://schema.org"}</script><link rel="stylesheet" href="https://saksdirect.github.io/hbc-tech-blog/assets/css/main.css"><link rel="canonical" href="https://saksdirect.github.io/hbc-tech-blog/ios/2016/09/26/custom-ios-gesture-recognizer/"><link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,700" rel="stylesheet"><link rel="shortcut icon" href="https://saksdirect.github.io/hbc-tech-blog/assets/images/favicon.ico"></head><body class="container" aria-label="Content"><header id="site-header" class="site-header"><a class="site-header__logo" href="https://saksdirect.github.io/hbc-tech-blog/"><svg class="hbc-tech-logo" xmlns="http://www.w3.org/2000/svg"><use class="hbc-tech-logo__use" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#hbc-tech-logo"></use></svg></a><p class="sticky-nav-meta"><a href="https://saksdirect.github.io/hbc-tech-blog/categories/#ios" class="meta__category">ios</a> <span class="meta__title">iOS Custom Gesture Recognizer</span></p><ul class="navigation"><li class="navigation__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/insights" class="navigation__link"><span class="navigation__link-highlight">Insights</span></a></li><li class="navigation__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/code" class="navigation__link"><span class="navigation__link-highlight">Code</span></a></li><li class="navigation__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/culture" class="navigation__link"><span class="navigation__link-highlight">Culture</span></a></li><li class="navigation__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/jobs" class="navigation__link"><span class="navigation__link-highlight">Work Here</span></a></li></ul></header><section class="content"><article class="article"><section class="article__no-feature-image"></section><section class="article__content"><div class="article-meta"><a href="https://saksdirect.github.io/hbc-tech-blog/categories/#ios" class="article-meta__category">ios</a> <span class="article-meta__date">Published 26 SEP 2016</span></div><h1 class="article__content__title" title="iOS Custom Gesture Recognizer">iOS Custom Gesture Recognizer</h1><div class="article__content__read-time"><span class="read-time" title="Estimated read time"><span class="read-time__text-1">4 mins</span> <span class="read-time__text-2">Read</span> <span class="read-time__text-3">Time</span></span></div><div class="article__content__share-buttons"><ul class="share-buttons"><li class="share-buttons__link-item"><a href="https://twitter.com/intent/tweet?text=https://saksdirect.github.io/hbc-tech-blog//ios/2016/09/26/custom-ios-gesture-recognizer/" class="share-buttons__link" title="Share on Twitter"><svg class="hbc-svg-icon" height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon--twitter" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#twitter"></use></svg></a></li><li class="share-buttons__link-item"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://saksdirect.github.io/hbc-tech-blog/&source=/ios/2016/09/26/custom-ios-gesture-recognizer/&title=iOS Custom Gesture Recognizer" class="share-buttons__link" title="Share on Linkedin"><svg height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#linkedin"></use></svg></a></li><li class="share-buttons__link-item"><a href="https://www.facebook.com/sharer/sharer.php?u=https://saksdirect.github.io/hbc-tech-blog//ios/2016/09/26/custom-ios-gesture-recognizer/" class="share-buttons__link" title="Share on Facebook"><svg height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#facebook"></use></svg></a></li><li class="share-buttons__link-item"><a href="https://www.reddit.com/submit?url=https://saksdirect.github.io/hbc-tech-blog//ios/2016/09/26/custom-ios-gesture-recognizer/" class="share-buttons__link" title="Share on Reddit"><svg height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#reddit"></use></svg></a></li></ul></div><div class="article__content__body"><h2 id="developing-new-product-photo-gallery">Developing New Product Photo Gallery</h2><p>As part of our Mobile team’s ongoing effort to introduce more Swift-based pages in the iOS app, I recently started working on a full screen gallery feature on our Product Detail Page (PDP). The feature is similar to the typical full screen photo gallery users will recognize from many other apps, including Apple’s Photo app and e-commerce applications featuring full screen view of product images.</p><p align="center"><img src="http://i.imgur.com/22y1I2Y.jpg"></p><h2 id="quick-way-to-exit-full-screen-view">Quick Way to Exit Full Screen View</h2><p>In order to offer the best shopping experience, we wanted to make sure our customers can easily enter and exit the full screen image view from PDP. Entering full screen view is easy - customers simply tap anywhere in the photo area. For exiting full screen view, we wanted to let customers scroll vertically with a single finger to zoom-out and, if enough zoom-out level is reached, exit full screen. Performing double finger pinch-in gesture to zoom-out beyond threshold level will also close the full screen view but single-finger gesture is much easier and more natural while holding the phone in one hand. It also helps customers browse through products faster. This is crucial when every second counts for grabbing last minute inventory on Gilt’s flash sales!</p><p align="center"><img src="http://i.imgur.com/C12f7Bs.jpg"></p><h2 id="adding-a-new-gesture-recognizer">Adding a New Gesture Recognizer</h2><p>When customers are on full screen image view, they can scroll left or right to browse the next or previous image. That screen movement is handled through <code class="highlighter-rouge">UIPanGestureRecognizer</code> - one of the built-in gesture recognizers in iOS. Gesture recognizers provide (x,y) coordinates of users’ finger movement as a gesture is performed. New (x,y) coordinates are captured and passed to application every 16.7ms, or 60Hz.</p><p>To allow browsing to the left or right, PanGesture listens for x-coordinate change in a user’s finger movement and moves screen to the left or right accordingly. It ignores y-coordinate change. For example, if a finger moves diagonally to the left, it creates the same effect as moving horizontally to the left as change in y-coordinates are ignored.</p><p>In order to support scroll-down-to-zoom-out-and-exit function, we added a new gesture recognizer that ignores x-coordinate changes and only recognizes y-coordinate change. That is, if a finger moves diagonally to the left, it will zoom out the image and, once enough zoom-out is applied, exit the screen. The application will zoom out images gradually as the y-coordinate changes, ignoring all x-coordinate changes.</p><p align="center"><img src="http://i.imgur.com/r0kyaq2.jpg"></p><h2 id="conflict">Conflict</h2><p>We now have two gesture recognizers on the same screen that perform opposite work of each other. One listens to delta X and ignores delta Y. The other one listens to delta Y and ignores delta X. Given how dense iOS device screens are and how fast finger movement is captured, it is very unlikely that a user’s finger movement is perfectly horizontal or vertical. Thus, we assume that we will always see diagonal movement, which changes both x and y coordinates at the same time. If a finger moves diagonally, we cannot let both gesture recognizers be activated because we must perform only one of the two actions - scroll to next/previous image or scroll-to-zoom-out.</p><p align="center"><img src="http://i.imgur.com/ewJasL2.jpg"></p><p>We know we have to pick one of the two recognizers very early on when gesture begins. That way, we know what to do with subsequent x, y coordinate changes. Interestingly, customers expect that too. They understand that if they start horizontally scrolling a page, the vertical change in their finger movement won’t have any effect while horizontal scroll is being performed. The same goes for scroll-down gesture. They expect that once their intention to scroll down is recognized, any change in horizontal movement during the rest of scroll would have no effect.</p><p>The question then is how do we read user’s intention very early in their finger movement and pick the right gesture recognizer to activate?</p><h2 id="solution">Solution</h2><p align="center"><img src="http://i.imgur.com/FrbvmmN.jpg"></p><p>The answer can be found in the first two set of coordinates obtained. We obtain the very first two set of coordinates and if delta Y &gt; delta X, then customers’ intention is to scroll down. If delta X &gt; delta Y, the intention is to scroll to the left or right. These two set of coordinates are obtained within a fraction of a second as mentioned above and thus the distance covered on the screen will be extremely short. Yet, this is indeed how users tell us what their intention is.</p><p>To include such decision process as part of gesture recognizer, I created a new custom gesture recognizer named <code class="highlighter-rouge">VerticalPanGestureRecognizer</code>. This recognizer will perform the above work at the very beginning of a finger movement and register itself as a success or failure depending on whether or not delta Y was greater than delta X. The regular horizontal movement is captured by <code class="highlighter-rouge">UIPanGestureRecognizer</code> and this recognizer is conditioned to activate only if <code class="highlighter-rouge">VerticalPanGestureRecognizer</code> fails.</p><p>I am sure all of us have come across mobile applications that support multiple gestures on the same screen. It is easy to take for granted that these applications detect exactly what our intention is. With all of the above in mind, now we can have a little more appreciation for all such convenience!</p></div><footer class="article__content__footer"><div class="article-tags"><span class="article-tags__tag">ios</span><span>,</span> <span class="article-tags__tag">gesture recognizer</span><span>,</span> <span class="article-tags__tag">paul lee</span></div><section class="author"><svg class="author__avatar" height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon hbc-svg-icon--avatar__circle" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#circle"></use><use class="hbc-svg-icon hbc-svg-icon--avatar__head" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#head"></use><use class="hbc-svg-icon hbc-svg-icon--avatar__body" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#body"></use></svg><span class="author__name">Paul Lee</span></section></footer></section></article><aside class="recirc"><h2 class="header__title">More Insights</h2><a class="header__view-all-link" href="https://saksdirect.github.io/hbc-tech-blog/categories/index.html">Explore Categories</a><div class="recirc__articles"><article class="recirc__articles__item"><section class="snippet"><a href="https://saksdirect.github.io/hbc-tech-blog/ios/2017/07/07/ios-notifciation-service-extension-tips/"></a><h1 class="snippet__title"><a href="https://saksdirect.github.io/hbc-tech-blog/ios/2017/07/07/ios-notifciation-service-extension-tips/" class="snippet__link" title="Advanced tips for building an iOS Notification Service Extension">Advanced tips for building an iOS Notification Service Extension</a></h1><div class="snippet__meta"><span class="meta__day">7</span> <span class="meta__month">JUL</span> <span class="meta__year">2017</span> <a class="meta__category-link" href="https://saksdirect.github.io/hbc-tech-blog/categories/#ios">ios</a>Kyle Dorman</div><a href="https://saksdirect.github.io/hbc-tech-blog/ios/2017/07/07/ios-notifciation-service-extension-tips/" class="snippet__link" title="Advanced tips for building an iOS Notification Service Extension"><p class="snippet__excerpt"></p></a></section></article><article class="recirc__articles__item"><section class="snippet"><a href="https://saksdirect.github.io/hbc-tech-blog/open%20source/2017/09/11/dublin-scala-spree/"></a><h1 class="snippet__title"><a href="https://saksdirect.github.io/hbc-tech-blog/open%20source/2017/09/11/dublin-scala-spree/" class="snippet__link" title="Dublin Scala Spree">Dublin Scala Spree</a></h1><div class="snippet__meta"><span class="meta__day">11</span> <span class="meta__month">SEP</span> <span class="meta__year">2017</span> <a class="meta__category-link" href="https://saksdirect.github.io/hbc-tech-blog/categories/#open source">open source</a>Gregor Heine</div><a href="https://saksdirect.github.io/hbc-tech-blog/open%20source/2017/09/11/dublin-scala-spree/" class="snippet__link" title="Dublin Scala Spree"><p class="snippet__excerpt">Dublin Scala Spree This Friday the Gilt/HBC Digital Dublin office will be hosting the first ever Dublin Scala Spree, a day-long Scala Open Source Hackathon. The event is organized by the Dublin Scala Usergroup in cooperation with Dublin Functional Kubs and the Scala Center at EPFL in Lausanne, Switzerland. Date &amp; Time: Friday, 15th September, 10am - 4pm Location: Gilt/HBC Digital Office, Shelbourne Rd., Dublin 4, Ireland Sign-Up: Please register...</p></a></section></article><article class="recirc__articles__item"><section class="snippet"><a href="https://saksdirect.github.io/hbc-tech-blog/conferences/2017/08/10/midyear-recap/"></a><h1 class="snippet__title"><a href="https://saksdirect.github.io/hbc-tech-blog/conferences/2017/08/10/midyear-recap/" class="snippet__link" title="HBC Tech Talks: February 2017 through July 2017">HBC Tech Talks: February 2017 through July 2017</a></h1><div class="snippet__meta"><span class="meta__day">10</span> <span class="meta__month">AUG</span> <span class="meta__year">2017</span> <a class="meta__category-link" href="https://saksdirect.github.io/hbc-tech-blog/category/conferences">conferences</a><a class="meta__author-link" href="https://saksdirect.github.io/hbc-tech-blog/authors/hbc-tech">HBC Tech</a></div><a href="https://saksdirect.github.io/hbc-tech-blog/conferences/2017/08/10/midyear-recap/" class="snippet__link" title="HBC Tech Talks: February 2017 through July 2017"><p class="snippet__excerpt">We’ve had a busy 2017 at HBC. The great work of our teams has created opportunities to share what we’ve learned with audiences around the world. This year our folks have been on stage in Austin, Sydney, Portland, Seattle, San Diego, Boston, London, Israel and on our home turf in NYC and Dublin. The talks have covered deep learning, design thinking, data streaming and developer experience to name just a...</p></a></section></article><article class="recirc__articles__item"><section class="snippet"><a href="https://saksdirect.github.io/hbc-tech-blog/data/2017/08/04/sundial-batch/"></a><h1 class="snippet__title"><a href="https://saksdirect.github.io/hbc-tech-blog/data/2017/08/04/sundial-batch/" class="snippet__link" title="Sundial or AWS Batch, Why not both?">Sundial or AWS Batch, Why not both?</a></h1><div class="snippet__meta"><span class="meta__day">4</span> <span class="meta__month">AUG</span> <span class="meta__year">2017</span> <a class="meta__category-link" href="https://saksdirect.github.io/hbc-tech-blog/categories/#data">data</a>Kevin O'Riordan</div><a href="https://saksdirect.github.io/hbc-tech-blog/data/2017/08/04/sundial-batch/" class="snippet__link" title="Sundial or AWS Batch, Why not both?"><p class="snippet__excerpt">About a year ago, we (the Gilt/HBC personalization team) open sourced Sundial , a batch job orchestration system leveraging Amazon EC2 Container Service.</p></a></section></article></div></aside></section><footer class="footer"><svg class="hbc-stripes-logo" xmlns="http://www.w3.org/2000/svg"><use class="hbc-stripes-logo__use" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#hbc-stripes-logo"></use></svg><section class="footer__links"><ul class="social-links social-links__list"><li class="social-links__list-item"><a class="social-links__link" rel="next" href="#"><svg class="social-links__icon" xmlns="http://www.w3.org/2000/svg"><use class="linkedin" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#linkedin"></use></svg></a></li><li class="social-links__list-item"><a class="social-links__link" rel="next" href="#"><svg class="social-links__icon" xmlns="http://www.w3.org/2000/svg"><use class="twitter" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#twitter"></use></svg></a></li><li class="social-links__list-item"><a class="social-links__link" rel="next" href="#"><svg class="social-links__icon" xmlns="http://www.w3.org/2000/svg"><use class="instagram" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/assets/images/hbc-icons.svg#instagram"></use></svg></a></li></ul><ul class="navigation navigation--footer"><li class="navigation__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/insights" class="navigation__link"><span class="navigation__link-highlight">Insights</span></a></li><li class="navigation__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/code" class="navigation__link"><span class="navigation__link-highlight">Code</span></a></li><li class="navigation__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/culture" class="navigation__link"><span class="navigation__link-highlight">Culture</span></a></li><li class="navigation__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/jobs" class="navigation__link"><span class="navigation__link-highlight">Work Here</span></a></li></ul><p class="copyright">&copy; 2017 HBC Tech</p></section></footer><script type="text/javascript" src="https://saksdirect.github.io/hbc-tech-blog/assets/js/vendor/scrollmagic/ScrollMagic.min.js"></script><script type="text/javascript" src="https://saksdirect.github.io/hbc-tech-blog/assets/js/vendor/scrollmagic/debug.addIndicators.min.js"></script><script type="text/javascript" src="https://saksdirect.github.io/hbc-tech-blog/assets/js/main.js"></script></body></html>