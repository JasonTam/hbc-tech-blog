<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Sundial PagerDuty Integration</title><title>Sundial PagerDuty Integration | HBC Tech</title><meta property="og:title" content="Sundial PagerDuty Integration"><meta name="author" content="Giovanni Gargiulo"><meta property="og:locale" content="en_US"><meta name="description" content="Sundial"><meta property="og:description" content="Sundial"><link rel="canonical" href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/2017-02-06-sundial-pagerduty-integration.html"><meta property="og:url" content="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/2017-02-06-sundial-pagerduty-integration.html"><meta property="og:site_name" content="HBC Tech"><meta property="og:type" content="article"><meta property="article:published_time" content="2017-02-06T00:00:00-05:00"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@"><meta name="twitter:creator" content="@Giovanni Gargiulo"><script type="application/ld+json">{"name":null,"description":"Sundial","author":{"@type":"Person","name":"Giovanni Gargiulo"},"@type":"BlogPosting","url":"https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/2017-02-06-sundial-pagerduty-integration.html","publisher":null,"image":null,"headline":"Sundial PagerDuty Integration","dateModified":"2017-02-06T00:00:00-05:00","datePublished":"2017-02-06T00:00:00-05:00","sameAs":null,"mainEntityOfPage":{"@type":"WebPage","@id":"https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/2017-02-06-sundial-pagerduty-integration.html"},"@context":"http://schema.org"}</script><link rel="stylesheet" href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/css/main.css"><link rel="canonical" href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/2017-02-06-sundial-pagerduty-integration.html"><link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,700" rel="stylesheet"><link rel="shortcut icon" href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/images/favicon.ico"></head><body aria-label="Content"><header id="site-header" class="site-header"><div class="site-header__inner"><a class="site-header__logo" href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/"><svg class="hbc-tech-logo" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 64 52"><use class="hbc-tech-logo__text" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/images/hbc-icons.svg#hbc-tech-logo"></use></svg></a><nav id="menu" class="navigation"><svg class="navigation__menu-icon" xmlns="http://www.w3.org/2000/svg"><path class="bar bar__top" d="M0,3 L30,3"></path><path class="bar bar__cross-1" d="M0,14 L30,14"></path><path class="bar bar__cross-2" d="M0,14 L30,14"></path><path class="bar bar__bottom" d="M0,25 L30,25"></path></svg><menu class="menu"><ul class="link-list"><li class="link-list__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/" class="link-list__link"><span class="link-list__link-highlight">Insights</span></a></li><li class="link-list__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/code" class="link-list__link"><span class="link-list__link-highlight">Code</span></a></li><li class="link-list__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/about" class="link-list__link"><span class="link-list__link-highlight">About</span></a></li><li class="link-list__link-item"><a href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/work-here" class="link-list__link"><span class="link-list__link-highlight">Work Here</span></a></li></ul></menu></nav><search id="header-search" class="header-search"><form class="header-search__form"><input type="text" class="header-search__input" id="header-search-input" placeholder="Search" name="query"></form><svg id="header-search__toggle" class="header-search__svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 64 52"><use class="header-search__icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/images/hbc-icons.svg#search"></use></svg><section class="header-search__results" id="header-search__results"></section></search></div></header><section class="content"><article class="article"><header class="article__header article__header--reveal"><h1 class="header-title" title="Sundial PagerDuty Integration">Sundial PagerDuty Integration</h1><span id="no-image-placeholder" class="no-image-placeholder"></span><div class="article-meta"><a href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/category/infrastructure" class="article-meta__category">infrastructure</a> <span class="slug-divider"></span> <span class="article-meta__author">Giovanni Gargiulo</span> <span class="slug-divider"></span> <span class="article-meta__date">FEB 6, 2017</span></div></header><section class="article__content article__content--reveal"><div class="article__content__read-time"><span class="read-time" title="Estimated read time"><span class="read-time__text-1">2 min</span> <span class="read-time__text-2">Read</span> <span class="read-time__text-3">Time</span></span></div><div class="article__content__share-buttons"><ul class="share-buttons"><li class="share-buttons__link-item"><a href="https://twitter.com/intent/tweet?text=https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog//2017-02-06-sundial-pagerduty-integration.html" class="share-buttons__link" title="Share on Twitter" target="_blank"><svg class="hbc-svg-icon" height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon--twitter" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/images/hbc-icons.svg#twitter"></use></svg></a></li><li class="share-buttons__link-item"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/&source=/2017-02-06-sundial-pagerduty-integration.html&title=Sundial PagerDuty Integration" class="share-buttons__link" title="Share on Linkedin" target="_blank"><svg height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/images/hbc-icons.svg#linkedin"></use></svg></a></li><li class="share-buttons__link-item"><a href="https://www.facebook.com/sharer/sharer.php?u=https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog//2017-02-06-sundial-pagerduty-integration.html" class="share-buttons__link" title="Share on Facebook" target="_blank"><svg height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/images/hbc-icons.svg#facebook"></use></svg></a></li><li class="share-buttons__link-item"><a href="https://www.reddit.com/submit?url=https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog//2017-02-06-sundial-pagerduty-integration.html" class="share-buttons__link" title="Share on Reddit" target="_blank"><svg height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/images/hbc-icons.svg#reddit"></use></svg></a></li></ul></div><div class="article__content__body"><h1 id="sundial">Sundial</h1><p>A few months ago, Gilt Tech announced <a href="https://github.com/gilt/sundial">Sundial</a>. Sundial is an open source batch job scheduler for Amazon ECS. Over the course of the last few months, Sundial has seen a significant adoption both inside and outside of Gilt.</p><p>Until Sundial v0.0.10, emailing was the only way of notifying job failures.</p><p>At the beginning when the number of jobs running on Sundial was small (and so was the number of failures!), it was fairly easy to spot emails of failed jobs and act accordingly.</p><p>Lately though, in the Personalization Team, Sundial schedules about a thousand job executions per day and it’s easy to imagine the amount of noise in our inbox generated by job notifications.</p><p>Beside the noise, it has happened more than once that failure of critical jobs went unnoticed. This was of course unacceptable.</p><p>Since <a href="https://www.pagerduty.com/">PagerDuty</a> is the <em>de facto</em> standard in Gilt when it comes to <em>on call procedures</em> and since PagerDuty offers a nice and reliable events <a href="https://v2.developer.pagerduty.com/docs/events-api">API</a>, we’ve redesigned the notification mechanism and integrated PagerDuty with Sundial.</p><h2 id="configuring-pagerduty-on-sundial">Configuring PagerDuty on Sundial</h2><p>Configuring your job to support both Emails and PagerDuty notifications is very straightforward and can be done by adding the following json snippet to your job definition:</p><div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
</span><span class="nt">"notifications"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"email"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"notify_when"</span><span class="p">:</span><span class="w"> </span><span class="s2">"on_state_change_and_failures"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"pagerduty"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"service_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"my_pd_service_key"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"num_consecutive_failures"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="nt">"api_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://events.pagerduty.com"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><p>Where</p><ul><li><em>notify_when</em> defines when email notifications will be sent. Possible values are:<ul><li><em>always</em>, Always notify when a process completes</li><li><em>on_failure</em>, Notify when a process fails</li><li><em>on_state_change</em>, Notify when a process goes from succeeding to failing and vice versa</li><li><em>on_state_change_and_failures</em>, Notify when going from failing to succeeded and on each failure</li><li><em>never</em></li></ul></li><li><em>my_pd_service_key</em> is the key obtained in the <em>Service Page</em> in PagerDuty</li><li><em>num_consecutive_failures</em> is the number of consecutive failures after which Sundial will trigger an alert in PagerDuty</li></ul><p>Please note that the <code class="highlighter-rouge">subscriptions</code> object in the Process Definition json has been deprecated, so if you’ve already adopted Sundial and want to start using the new <code class="highlighter-rouge">notifications</code>, you will have to update your json accordingly.</p><p>More details can be found in the <a href="https://github.com/gilt/sundial/releases/tag/v0.0.10">Sundial v.0.0.10 release page</a></p></div><footer class="article__content__footer"><div class="article-tags"><span class="article-tags__tag">aws</span><span>,</span> <span class="article-tags__tag">sundial</span><span>,</span> <span class="article-tags__tag">pagerduty</span></div><section class="author-bio"><svg class="author-bio__avatar" height="36" width="36" xmlns="http://www.w3.org/2000/svg"><use class="hbc-svg-icon hbc-svg-icon--avatar__circle" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/images/hbc-icons.svg#circle"></use><use class="hbc-svg-icon hbc-svg-icon--avatar__head" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/images/hbc-icons.svg#head"></use><use class="hbc-svg-icon hbc-svg-icon--avatar__body" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/images/hbc-icons.svg#body"></use></svg><span class="author-bio__name">Giovanni Gargiulo</span></section></footer></section><aside class="recirc"><h2 class="header__title">Recent Insights</h2><span class="slug-divider"></span> <a class="header__view-all-link" href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/categories/index.html">See All</a><div class="recirc__articles"><article class="recirc__articles__item"><section class="snippet"><h1 class="snippet__title"><a href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/2018-01-16-sundial-aws-emr-integration.html" class="snippet__title__link" title="Sundial AWS EMR Integration">Sundial AWS EMR Integration</a></h1><div class="snippet__meta"><a class="meta__category-link" href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/categories/#aws">aws</a> <span class="slug-divider"></span> <span class="meta__author">Giovanni Gargiulo</span> <span class="slug-divider"></span> <span class="meta__date">JAN 16, 2018</span></div><a href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/2018-01-16-sundial-aws-emr-integration.html" class="snippet__excerpt__link" title="Sundial AWS EMR Integration"><p class="snippet__excerpt">AWS Elastic Map Reduce on Sundial</p></a></section></article><article class="recirc__articles__item"><section class="snippet"><h1 class="snippet__title"><a href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/2017-05-19-cloudformation-nanoservice.html" class="snippet__title__link" title="CloudFormation Nanoservice">CloudFormation Nanoservice</a></h1><div class="snippet__meta"><a class="meta__category-link" href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/category/infrastructure">infrastructure</a> <span class="slug-divider"></span> <span class="meta__author">Ryan Martin</span> <span class="slug-divider"></span> <span class="meta__date">MAY 19, 2017</span></div><a href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/2017-05-19-cloudformation-nanoservice.html" class="snippet__excerpt__link" title="CloudFormation Nanoservice"><p class="snippet__excerpt">One of the big HBC Digital initiatives for 2017 is “buy online, pickup in store” - somewhat awkwardly nicknamed “BOPIS” internally. This is the option for the customer to, instead of shipping an order to an address, pick it up in a store that has the items in inventory.</p></a></section></article><article class="recirc__articles__item"><section class="snippet"><h1 class="snippet__title"><a href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/2017-01-25-keep-an-eye-on-your-stack-with-cloudwatch-events-lambda.html" class="snippet__title__link" title="Keeping an Extra Eye on Your Stack with CloudWatch Events">Keeping an Extra Eye on Your Stack with CloudWatch Events</a></h1><div class="snippet__meta"><a class="meta__category-link" href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/category/infrastructure">infrastructure</a> <span class="slug-divider"></span> <span class="meta__author">Emerson Loureiro</span> <span class="slug-divider"></span> <span class="meta__date">JAN 25, 2017</span></div><a href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/2017-01-25-keep-an-eye-on-your-stack-with-cloudwatch-events-lambda.html" class="snippet__excerpt__link" title="Keeping an Extra Eye on Your Stack with CloudWatch Events"><p class="snippet__excerpt">Why an Extra Eye?</p></a></section></article><article class="recirc__articles__item"><section class="snippet"><h1 class="snippet__title"><a href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/2016-04-01-mega-service-gilt.html" class="snippet__title__link" title="Breaking the Mold: Megaservice Architecture at Gilt">Breaking the Mold: Megaservice Architecture at Gilt</a></h1><div class="snippet__meta"><a class="meta__category-link" href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/category/infrastructure">infrastructure</a> <span class="slug-divider"></span> <span class="meta__author">Adrian Trenaman</span> <span class="slug-divider"></span> <span class="meta__date">APR 1, 2016</span></div><a href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/2016-04-01-mega-service-gilt.html" class="snippet__excerpt__link" title="Breaking the Mold: Megaservice Architecture at Gilt"><p class="snippet__excerpt">Today we announce a novel approach to software and system architecture that we’ve been experimenting with for the last while at Gilt: internally, we’ve been referring to it ‘mega-service’ architecture, and, the name seems to have stuck. We’re pretty excited about it, as it represents a real paradigm shift for us.</p></a></section></article></div></aside></article></section><footer class="footer"><svg class="est1670" xmlns="http://www.w3.org/2000/svg"><use class="hbc-tech-logo__use" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/images/hbc-icons.svg#est1670"></use></svg><section class="footer__links"><ul class="social-links social-links__list"><li class="social-links__list-item"><a class="social-links__link" target="_blank" rel="next" href="https://www.linkedin.com/company/hbc_digital/"><svg class="social-links__icon" xmlns="http://www.w3.org/2000/svg"><use class="linkedin" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/images/hbc-icons.svg#linkedin"></use></svg></a></li><li class="social-links__list-item"><a class="social-links__link" target="_blank" rel="next" href="https://twitter.com/hbcdigital/"><svg class="social-links__icon" xmlns="http://www.w3.org/2000/svg"><use class="twitter" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/images/hbc-icons.svg#twitter"></use></svg></a></li><li class="social-links__list-item"><a class="social-links__link" target="_blank" rel="next" href="https://www.instagram.com/hbcdigital"><svg class="social-links__icon" xmlns="http://www.w3.org/2000/svg"><use class="instagram" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/images/hbc-icons.svg#instagram"></use></svg></a></li></ul><p class="copyright">&copy; 2018 HBC Tech</p></section></footer><script type="text/javascript" src="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/js/vendor/scrollmagic/ScrollMagic.min.js"></script><script type="text/javascript" src="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/js/vendor/jekyll-search-js/fetch.js"></script><script type="text/javascript" src="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/js/vendor/jekyll-search-js/search.js"></script><script type="text/javascript" src="https://saksdirect.github.io/hbc-tech-blog/hbc-tech-blog/assets/js/main.js"></script></body></html>